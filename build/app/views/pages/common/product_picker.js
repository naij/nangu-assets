define("app/views/pages/common/product_picker",["magix","jquery","underscore","app/mixins/dialog"],function(t,e,a){var i=t("magix"),s=t("jquery"),c=(t("underscore"),t("app/mixins/dialog"));a.exports=i.View.extend({tmpl:'<div class="product-picker"><div class="dialog-hd"><h2 class="dialog-title">\u9009\u62e9\u8df3\u8f6c\u9875\u9762</h2></div><div class="dialog-bd"><ul class="product-tab clearfix">{{#for(item in tabList)}}<li mx-click="switchTab({index:{{__INDEX__}}})" t-class:active="item.selected">{{item.title}}</li>{{/for}}</ul><ul class="product-container clearfix">{{#for(item in list)}}<li t-class:selected="item.selected" mx-click="pick({id:{{item.id}}})"><div class="img-wrapper"><img class="img" src="{{item.cover}}"></div><div class="title">{{item.title}}</div><div class="mask"><span class="iconfont iconduigou"></span></div></li>{{/for}}</ul><div class="pager-container" mx-view="app/coms/pagination/pagination?total={{totalCount}}&size={{pageSize}}&page={{pageNo}}" mx-change="pageChange()"></div></div><div class="dialog-ft"><a href="javascript:;" class="btn btn-brand btn-large mr10" mx-click="submit()" t-if="selectedItem">\u786e\u5b9a</a><a href="javascript:;" class="btn btn-disabled btn-large mr10" t-if="!selectedItem">\u786e\u5b9a</a><a href="javascript:;" class="btn btn-normal btn-large" mx-click="cancel()">\u53d6\u6d88</a></div></div>',mixins:[c],init:function(t){this.extraData=t},render:function(){var t=this;t.data={tabList:[{title:"\u6d3b\u52a8",categoryId:"10015",selected:!0},{title:"\u6c11\u5bbf",categoryId:"10014"}],categoryId:"10015"},t.setView(),t._getList()},_getList:function(){var t=this,e=t.pageNo||1,a=8,i=t.data.categoryId;t.request().all([{name:"product_list",params:{categoryId:i,status:"1,2",pageNo:e,pageSize:a}}],function(i,s){var c=s.get("data");t.data={list:c.list,pageNo:e,pageSize:a,totalCount:c.totalCount},t.setView()})},"pick<click>":function(t){var e,a=this,i=t.params.id,c=a.data.list;s.each(c,function(t,a){a.selected=!1,a.id==i&&(a.selected=!0,e=a)}),a.data={list:c,selectedItem:e},a.setView()},"search<keydown>":function(t){"13"==t.keyCode&&(this.q=s(t.eventTarget).val(),this.pageNo=1,this.render())},"switchTab<click>":function(t){var e=this,a=e.data.tabList;a.forEach(function(a,i){a.selected=!1,i==t.params.index&&(a.selected=!0,e.data.categoryId=a.categoryId)}),e.data.tabList=a,e.data.selectedItem="",e.setView(),e.pageNo=1,e._getList()},"pageChange<change>":function(t){this.pageNo=t.state.page,this.render()},"submit<click>":function(t){t.preventDefault();var e,a=this.data.categoryId;switch(a){case"10014":e="/pages/roomvoucher/detail?id="+this.data.selectedItem.productSn;break;case"10015":e="/pages/activity/detail?id="+this.data.selectedItem.productSn}this.extraData.dialog.close(),this.extraData.callback(e)},"cancel<click>":function(t){t.preventDefault(),this.extraData.dialog.close()}})});