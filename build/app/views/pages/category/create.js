define("app/views/pages/category/create",["magix","jquery","app/mixins/dialog"],function(e,a,t){var i=e("magix"),s=e("jquery"),l=e("app/mixins/dialog");t.exports=i.View.extend({tmpl:'<div class="page-header clearfix"><div class="title-bar"><h2 class="title" t-if="categoryId">\u7f16\u8f91\u7c7b\u76ee</h2><h2 class="title" t-if="!categoryId">\u65b0\u589e\u7c7b\u76ee</h2></div></div><div class="page-body spu-create"><form id="category-create-form"><ul class="union-form"><li class="field"><p class="field-label2">\u7c7b\u76ee\u540d\u79f0</p><input type="text" class="input" name="name" value="{{name}}"></li><li class="field"><p class="field-label2">\u4e0a\u7ea7\u5206\u7c7b</p><select class="select" name="parentId" disabled="{{categoryId ? true : false}}">{{#for(item in categoryList)}}<option value="{{item.categoryId}}" selected="{{item.selected}}">{{item.name}}</option>{{/for}}</select></li><li class="field"><a href="#" class="btn btn-brand btn-large" mx-click="submit()">\u63d0\u4ea4</a></li></ul></form></div>',mixins:[l],render:function(){var e=this,a=e.param("categoryId"),t=e.param("parentId");a?e.request().all([{name:"category_detail",params:{categoryId:a}},{name:"category_list"}],function(i,l,r){var c=l.get("data"),d=r.get("data"),n=d.list;n.push({categoryId:"0",name:"\u65e0\u4e0a\u7ea7\u5206\u7c7b",selected:!0}),0!==t&&s.each(n,function(e,a){a.selected=!1,a.categoryId==t&&(a.selected=!0)}),e.data={categoryId:a,name:c.name,categoryList:n},e.setView()}):e.request().all([{name:"category_list"}],function(a,t){var i=t.get("data"),s=i.list;s.push({categoryId:"0",name:"\u65e0\u4e0a\u7ea7\u5206\u7c7b",selected:!0}),e.data={categoryList:s},e.setView()})},"submit<click>":function(e){e.preventDefault();var a,t=this,i=t.data.categoryId,l=s("#category-create-form").serializeJSON({useIntKeysAsArrayIndex:!0});i?(l.categoryId=i,a="category_update"):a="category_create",t.request().all([{name:a,params:l}],function(){t.to("/category/list")})}})});