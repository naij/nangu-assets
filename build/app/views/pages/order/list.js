define("app/views/pages/order/list",["magix","jquery","app/mixins/dialog"],function(t,a,s){var e=t("magix"),i=t("jquery"),r=t("app/mixins/dialog");s.exports=e.View.extend({tmpl:'<div class="page-header clearfix"><div class="title-bar"><h2 class="title">\u8ba2\u5355\u5217\u8868</h2></div></div><div class="page-body order-list"><div class="filter"><form class="union-form" id="filter-form"><div class="col"><div class="field"><span class="label">\u4e70\u5bb6\u6635\u79f0\uff1a</span><input type="text" class="input" name="memberNickname" value="{{memberNickname}}"></div><div class="field"><span class="label">\u8ba2\u5355\u7f16\u53f7\uff1a</span><input type="text" class="input" name="orderSn" value="{{orderSn}}"></div><div class="field"><button class="btn btn-brand" mx-click="search()">\u641c\u7d22\u8ba2\u5355</button></div></div><div class="col"></div></form></div><div class="table-container"><div class="tabbar"><ul class="clearfix"><li t-class:active="status==\'\'" mx-click="status({status:\'\'})">\u5168\u90e8\u8ba2\u5355</li><li t-class:active="status==1" mx-click="status({status:1})">\u5f85\u4ed8\u6b3e</li><li t-class:active="status==2" mx-click="status({status:2})">\u5904\u7406\u4e2d</li><li t-class:active="status==3" mx-click="status({status:3})">\u5df2\u4ed8\u6b3e</li><li t-class:active="status==4" mx-click="status({status:4})">\u5df2\u5b8c\u6210</li></ul></div><table class="table"><thead><tr t-class:no-data="list.length == 0"><th class="left">\u5546\u54c1\u4fe1\u606f</th><th class="left" width="80">\u5355\u4ef7</th><th class="left" width="80">\u6570\u91cf</th><th class="left" width="80">\u5b9e\u6536\u6b3e</th><th class="left" width="100">\u4e70\u5bb6\u6635\u79f0</th><th class="left" width="80">\u552e\u540e</th><th class="left" width="80">\u4ea4\u6613\u72b6\u6001</th><th class="center" width="100">\u64cd\u4f5c</th></tr></thead><tbody>{{#for(item in list)}}<tr class="purple"><td class="left" colspan="8"><span class="mr20">\u8ba2\u5355\u7f16\u53f7\uff1a{{item.orderSn}}</span><span>\u521b\u5efa\u65f6\u95f4\uff1a{{item.createdAt|formatDate}}</span></td></tr><tr><td class="left"><div class="order-product-info"><img class="img" src="{{item.productInfo.productCover}}"><div class="attr"><div class="title">{{item.productInfo.productTitle}}</div><div class="properties">{{item.productInfo.productPropertiesName}}</div></div></div></td><td class="left">\uffe5{{item.productInfo.productPrice}}</td><td class="left">{{item.productQuantity}}</td><td class="left"><strong>\uffe5{{item.paymentAmount}}</strong></td><td class="left">{{item.memberNickname}}</td><td class="left">{{#if(item.refundInfo)}}<a href="/order/refund_detail?id={{item.refundInfo.id}}" class="color-blue mr10">{{{item.refundInfo.status|formatRefundStatus}}}</a>{{/if}}</td><td class="left">{{{item.orderStatus|formatStatus}}}</td><td class="center"><p><a href="/order/detail?orderSn={{item.orderSn}}" class="color-blue mr10">\u67e5\u770b\u8ba2\u5355</a></p><p t-if="item.orderStatus==3 && !item.refundInfo"><a href="#" class="color-blue mr10" mx-click="verification({orderSn:\'{{item.orderSn}}\'})">\u6838\u9500\u8ba2\u5355</a></p></td></tr>{{/for}} {{#if(list.length == 0)}}<tr class="none"><td class="center" colspan="8">\u6682\u65e0\u6570\u636e</td></tr>{{/if}}</tbody></table><div class="tfoot"><div class="pager-container" mx-view="app/coms/pagination/pagination?total={{totalCount}}&size={{pageSize}}&page={{pageNo}}" mx-change="pageChange()"></div></div></div></div>',mixins:[r],ctor:function(){this.observe(["pageNo","productTitle","memberNickname","orderSn","status"])},render:function(){var t=this,a=t.param("pageNo")||1,s=10,e=t.param("memberNickname"),i=t.param("orderSn"),r=t.param("status");t.request().all([{name:"order_list",params:{memberNickname:e,orderSn:i,status:r,pageNo:a,pageSize:s}}],function(l,c){var n=c.get("data");t.data={list:n.list,orderSn:i,memberNickname:e,status:r,pageNo:a,pageSize:s,totalCount:n.totalCount},t.setView()})},"search<click>":function(t){t.preventDefault();var a=i("#filter-form").serializeJSON();this.to(a)},"status<click>":function(t){this.to({status:t.params.status,pageNo:1})},"pageChange<change>":function(t){this.to({pageNo:t.state.page})},"verification<click>":function(t){t.preventDefault();var a=this,s=t.params.orderSn;a.confirm("\u786e\u5b9a\u8981\u6838\u9500\u6b64\u5546\u54c1\u5417\uff1f",function(){a.request().all([{name:"order_update_status",params:{orderSn:s,orderStatus:4}}],function(){a.render()})})},filters:{formatStatus:function(t){var a;switch(t){case 0:a='<span class="color-m">\u5df2\u5173\u95ed</span>';break;case 1:a='<span class="color-orange">\u5f85\u4ed8\u6b3e</span>';break;case 2:a='<span class="color-orange">\u5f85\u5904\u7406</span>';break;case 3:a='<span class="color-green">\u5df2\u4ed8\u6b3e</span>';break;case 4:a='<span class="color-green">\u5df2\u5b8c\u6210</span>';break;case 99:a='<span class="color-m">\u7528\u6237\u5220\u9664</span>'}return a},formatRefundStatus:function(t){var a;switch(t){case 0:a='<span class="color-m">\u9000\u6b3e\u62d2\u7edd</span>';break;case 1:a='<span class="color-orange">\u9000\u6b3e\u5f85\u5904\u7406</span>';break;case 2:a='<span class="color-orange">\u9000\u6b3e\u4e2d</span>';break;case 3:a='<span class="color-green">\u9000\u6b3e\u6210\u529f</span>'}return a}}})});