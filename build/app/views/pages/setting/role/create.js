define("app/views/pages/setting/role/create",["magix","jquery","app/mixins/dialog"],function(e,a,i){var s=e("magix"),t=e("jquery"),l=e("app/mixins/dialog");i.exports=s.View.extend({tmpl:'<div class="page-header clearfix"><div class="title-bar"><h2 class="title" t-if="id">\u7f16\u8f91\u89d2\u8272</h2><h2 class="title" t-if="!id">\u65b0\u589e\u89d2\u8272</h2></div></div><div class="page-body role-create"><form id="role-create-form"><ul class="union-form"><li class="field"><p class="field-label2">\u89d2\u8272\u540d\u79f0</p><input type="text" class="input" name="name" value="{{name}}"></li><li class="field"><p class="field-label2">\u72b6\u6001</p><label class="mr10" mx-click="switchStatus({value:1})"><input name="status" class="mr10" checked="{{status==1}}" type="radio" value="1"/><span>\u6b63\u5e38</span></label><label mx-click="switchStatus({value:2})"><input name="status" class="mr10" checked="{{status==2}}" type="radio" value="2"/><span>\u7981\u7528</span></label></li><li class="field"><p class="field-label2">\u83dc\u5355\u6743\u9650</p><div class="menu"><dl>{{#for(item in menuList)}}<dt><label><input type="checkbox" name="menuPermission[]m{{item.id}}" value="{{item.id}}" checked="{{item.selected}}"><span>{{item.name}}</span></label></dt>{{#for(subItem in item.subMenuList)}}<dd><label><input type="checkbox" name="menuPermission[]m{{subItem.id}}" value="{{subItem.id}}" checked="{{subItem.selected}}"><span>{{subItem.name}}</span></label></dd>{{/for}} {{/for}}</dl></div></li><li class="field"><a href="#" class="btn btn-brand btn-large" mx-click="submit()">\u63d0\u4ea4</a></li></ul></form></div>',mixins:[l],render:function(){var e=this,a=e.param("id");a?e.request().all([{name:"role_detail",params:{id:a}},{name:"menu_full_list"}],function(i,s,l){var n=s.get("data"),d=l.get("data"),m=d.list,u=n.menuPermission;t.each(m,function(e,a){u["m"+a.id]&&(a.selected=!0),t.each(a.subMenuList,function(e,a){u["m"+a.id]&&(a.selected=!0)})}),e.data={id:a,name:n.name,status:n.status,menuList:m},e.setView()}):e.request().all([{name:"menu_full_list"}],function(a,i){var s=i.get("data");e.data={status:1,menuList:s.list},e.setView()})},"submit<click>":function(e){e.preventDefault();var a,i=this,s=i.data.id,l=t("#role-create-form").serializeJSON({useIntKeysAsArrayIndex:!0});s?(l.id=s,a="role_update"):a="role_create",i.request().all([{name:a,params:l}],function(){window.history.go(-1)})}})});