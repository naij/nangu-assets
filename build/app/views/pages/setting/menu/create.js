define("app/views/pages/setting/menu/create",["magix","jquery","app/mixins/dialog"],function(e,a,t){var i=e("magix"),l=e("jquery"),s=e("app/mixins/dialog");t.exports=i.View.extend({tmpl:'<div class="page-header clearfix"><div class="title-bar"><h2 class="title" t-if="id">\u7f16\u8f91\u83dc\u5355</h2><h2 class="title" t-if="!id">\u65b0\u589e\u83dc\u5355</h2></div></div><div class="page-body"><form id="menu-create-form"><ul class="union-form"><li class="field"><p class="field-label2">\u83dc\u5355\u540d\u79f0</p><input type="text" class="input" name="name" value="{{name}}"></li><li class="field"><p class="field-label2">\u56fe\u6807</p><input type="text" class="input" name="icon" value="{{icon}}"></li><li class="field"><p class="field-label2">\u8def\u5f84</p><input type="text" class="input" name="path" value="{{path}}"></li><li class="field"><p class="field-label2">\u5173\u8054\u8def\u5f84</p><textarea name="relativePath" class="textarea">{{relativePath|formatRelativePath}}</textarea></li><li class="field"><p class="field-label2">\u6392\u5e8f</p><input type="text" class="input" name="sort" value="{{sort}}"></li><li class="field"><p class="field-label2">\u4e0a\u7ea7\u5206\u7c7b</p><select class="select" name="parentId">{{#for(item in menuList)}}<option value="{{item.id}}" selected="{{item.selected}}">{{item.name}}</option>{{/for}}</select></li><li class="field"><a href="#" class="btn btn-brand btn-large" mx-click="submit()">\u63d0\u4ea4</a></li></ul></form></div>',mixins:[s],render:function(){var e=this,a=e.param("id"),t=e.param("parentId");a?e.request().all([{name:"menu_detail",params:{id:a}},{name:"menu_list"}],function(i,s,n){var r=s.get("data"),c=n.get("data"),d=c.list;d.push({id:"0",name:"\u65e0\u4e0a\u7ea7\u5206\u7c7b",selected:!0}),0!==t&&l.each(d,function(e,a){a.selected=!1,a.id==t&&(a.selected=!0)}),e.data={id:a,name:r.name,icon:r.icon,path:r.path,relativePath:r.relativePath,sort:r.sort,menuList:d},e.setView()}):e.request().all([{name:"menu_list"}],function(a,t){var i=t.get("data"),l=i.list;l.push({id:"0",name:"\u65e0\u4e0a\u7ea7\u5206\u7c7b",selected:!0}),e.data={menuList:l},e.setView()})},"submit<click>":function(e){e.preventDefault();var a,t=this,i=t.data.id,s=l("#menu-create-form").serializeJSON({useIntKeysAsArrayIndex:!0}),n=s.relativePath;n?(n=n.split(/[(\r\n)\r\n]+/),s.relativePath=n.join()):s.relativePath="",i?(s.id=i,a="menu_update"):a="menu_create",t.request().all([{name:a,params:s}],function(){window.history.go(-1)})},filters:{formatRelativePath:function(e){return e?e.split(",").join("\r\n"):""}}})});