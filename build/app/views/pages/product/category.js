define("app/views/pages/product/category",["magix","jquery"],function(t,e,a){var i=t("magix"),s=t("jquery");a.exports=i.View.extend({tmpl:'<div class="page-header clearfix"><div class="title-bar"><h2 class="title">\u9009\u62e9\u7c7b\u76ee</h2></div></div><div class="page-body"><div class="product-publish-category"><div class="category-list-container clearfix"><div class="category-list">{{#for(item in parentList)}}<div class="category-item" t-class:selected="item.selected" mx-click="switchParentCategory({parentId:{{item.categoryId}},index:{{__INDEX__}}})"><span>{{item.name}}</span><span class="iconfont iconjiantou"></span></div>{{/for}}</div><div class="category-list">{{#for(item in childList)}}<div class="category-item" t-class:selected="item.selected" mx-click="switchChildCategory({categoryId:{{item.categoryId}},index:{{__INDEX__}}})"><span>{{item.name}}</span><span class="iconfont iconjiantou"></span></div>{{/for}}</div></div><div class="publish"><button class="btn btn-brand btn-large" t-class:btn-disabled="categoryId?false:true" disabled="{{categoryId?false:true}}" mx-click="gotoPublish()">\u4e0b\u4e00\u6b65\uff0c\u53d1\u5e03\u5546\u54c1</button></div></div></div>',ctor:function(){this.observe(["pageNo"])},render:function(){var t=this;t._getCategoryList(0,function(e){var a=e.list;a[0].selected=!0,t._getCategoryList(a[0].categoryId,function(e){var i=e.list;i[0].selected=!0;var s=i[0].categoryId;t.data={parentList:a,childList:i,categoryId:s},t.setView()})})},_getCategoryList:function(t,e){this.request().all([{name:"category_list",params:{parentId:t||0,pageNo:1,pageSize:50}}],function(t,a){e(a.get("data"))})},"switchParentCategory<click>":function(t){t.preventDefault();var e=t.params.parentId,a=t.params.index,i=this,c=i.data.parentList;s.each(c,function(t,e){e.selected=!1,t==a&&(e.selected=!0)}),i._getCategoryList(e,function(t){var e=t.list;i.data={parentList:c,childList:e,categoryId:""},i.setView()})},"switchChildCategory<click>":function(t){t.preventDefault();var e,e=t.params.categoryId,a=t.params.index,i=this,c=i.data.childList;s.each(c,function(t,i){i.selected=!1,t==a&&(i.selected=!0,e=i.categoryId)}),i.data={childList:c,categoryId:e},i.setView()},"gotoPublish<click>":function(){this.to("/product/publish?categoryId="+this.data.categoryId)}})});