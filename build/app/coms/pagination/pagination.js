define("app/coms/pagination/pagination",["magix","jquery","underscore"],function(a,e,t){var i=a("magix"),n=a("jquery"),s=a("underscore");t.exports=i.View.extend({tmpl:'<div class="pager"><ul><li class="num num-prev" t-class:notallowed="page == 1"><a href="javascript:;" t-bind:mx-click="page > 1 ? \'toPrev()\' : \'\'"><span class="quanfont icon-back"></span><span>\u4e0a\u4e00\u9875</span></a></li><li class="num" t-if="start > 1"><a href="javascript:;" mx-click="toPage({page:1})">1</a></li><li class="notallowed num" t-if="start > 2"><a href="javascript:;">...</a></li>{{#for(i in pageNums)}}<li class="num" t-class:active="page == i"><a href="javascript:;" mx-click="toPage({page:{{i}}})">{{i}}</a></li>{{/for}}<li class="num notallowed" t-if="end + 2 < pages"><a href="javascript:;">...</a></li><li class="num" t-if="end < pages"><a href="javascript:;" mx-click="toPage({page:{{pages}}})">{{pages}}</a></li><li class="num num-next" t-class:notallowed="page == pages"><a href="javascript:;" t-bind:mx-click="page < pages ? \'toNext()\' : \'\'"><span>\u4e0b\u4e00\u9875</span><span class="quanfont icon-more"></span></a></li></ul></div>',init:function(a){var e=this;e.$extra=a;var t=a.step||7,i=0|a.total||0,n=a.size||20,s=Math.ceil((i||1)/n),r=a.page||1;e.data={step:t,page:r,pages:s,total:i,size:n}},render:function(){var a=this;s.extend(a.data,a.cal()),a.setView()},cal:function(){var a=this,e=a.data,t=0|e.page,i=0|e.pages;t>i&&(t=i);var n=0|e.step,s=n/2|0,r=Math.max(1,t-s),p=Math.min(i,r+n-1);r=Math.max(1,p-n+1);var c;2>=r&&(c=3-r,i>p+c&&(p+=c)),p+2>i&&(c=2-(i-p),r-c>1&&(r-=c)),3==r&&(r-=1),p+2==i&&(p+=1);for(var l=[],o=r;p>=o;o++)l.push(o);return{offsetStart:(t-1)*e.size+1,offsetEnd:Math.min(e.total,t*e.size),page:t,start:r,end:p,pageNums:l}},fireEvent:function(){var a=this,e=n("#"+a.id),t=a.data;e.trigger({type:"change",state:{page:t.page,size:t.size}})},"toPage<click>":function(a){a.preventDefault();var e=this;e.data.page=a.params.page,e.render(),e.fireEvent()},"toPrev<click>":function(a){a.preventDefault();var e=this;e.data.page=e.data.page-1,e.render(),e.fireEvent()},"toNext<click>":function(a){a.preventDefault();var e=this;e.data.page=e.data.page+1,e.render(),e.fireEvent()},"changeSize<change>":function(a){a.stopPropagation();var e=this;e.data.page=1,e.data.size=a.item,e.render(),e.fireEvent()}})});