define("app/models/service",["magix","jquery"],function(e,o,t){var a=e("magix"),r=e("jquery"),n=a.Service.extend(function(e,o){var t={method:"GET",dataType:"json"},n=e.get("params")||e.get("formParams")||e.get("urlParams")||{},d=e.get("url"),p=e.get("method")||t.method,c=e.get("dataType")||t.dataType,s=[];if("POST"==p.toUpperCase()&&(n._csrf=a.config("csrf")),r.extend(n,{t:+new Date}),"object"==typeof n){for(var i in n)n.hasOwnProperty(i)&&s.push("object"==typeof n[i]?i+"="+encodeURIComponent(JSON.stringify(n[i])):i+"="+encodeURIComponent(n[i]));n=s.join("&")}r.ajax({url:a.toUrl(d),dataType:c,data:n,type:p,complete:function(t,a){if("error"===a)console.log("error....");else{var n=r.parseJSON(t.responseText);n.code&&200===n.code?(e.set("data",n.data),o()):n.code&&403===n.code&&(location.href="/member/login")}}})});t.exports=n});